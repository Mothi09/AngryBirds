<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mini Angry Birds</title>
<style>
  body{ margin:0; display:flex; justify-content:center; align-items:center; height:100vh; background:#a0d8f1; }
  canvas{ background:linear-gradient(#9ed0ff,#7cc8ff); border:2px solid #333; border-radius:8px; }
</style>
</head>
<body>
<canvas id="game" width="720" height="420"></canvas>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const W=canvas.width,H=canvas.height;

const gravity=900, dt=1/60;
let birdsLeft=5, score=0, shotsUsed=0;
let blocks=[
  {x:520,y:H-60,w:40,h:48,hp:100},
  {x:570,y:H-60,w:40,h:48,hp:100},
  {x:545,y:H-100,w:120,h:24,hp:140}
];

const sling={x:120,y:H-110};
const birdRadius=16;
let currentBird=null;

const mouse={x:0,y:0,down:false};

// helpers
function clamp(v,a,b){return Math.max(a,Math.min(b,v));}
function pointInCircle(px,py,c){return Math.hypot(px-c.x,py-c.y)<=c.r;}
function getCanvasPos(e){
  const rect=canvas.getBoundingClientRect();
  if(e.touches && e.touches[0]) e=e.touches[0];
  return {x:(e.clientX-rect.left)*(canvas.width/rect.width), y:(e.clientY-rect.top)*(canvas.height/rect.height)};
}
function makeBird(){ return {x:sling.x, y:sling.y, r:birdRadius, vx:0, vy:0, launched:false, alive:true, stuck:true}; }
function nextBird(){ if(birdsLeft>0){ currentBird=makeBird(); birdsLeft--; shotsUsed++; } else currentBird=null; }
nextBird();

// input
canvas.addEventListener('mousedown', (e)=>{ mouse.down=true; mouse.x=getCanvasPos(e).x; mouse.y=getCanvasPos(e).y; });
canvas.addEventListener('mousemove', (e)=>{ mouse.x=getCanvasPos(e).x; mouse.y=getCanvasPos(e).y;
  if(mouse.down && currentBird && currentBird.stuck){
    const dx=mouse.x-sling.x, dy=mouse.y-sling.y;
    const mag=Math.hypot(dx,dy), max=110;
    currentBird.x=sling.x+dx/mag*Math.min(mag,max);
    currentBird.y=sling.y+dy/mag*Math.min(mag,max);
  }
});
canvas.addEventListener('mouseup', (e)=>{
  mouse.down=false;
  if(currentBird && currentBird.stuck){
    const dx=sling.x-currentBird.x, dy=sling.y-currentBird.y;
    currentBird.vx=dx*5.5; currentBird.vy=dy*5.5;
    currentBird.launched=true; currentBird.stuck=false;
  }
});
canvas.addEventListener('touchstart',(e)=>{ e.preventDefault(); mouse.down=true; mouse.x=getCanvasPos(e).x; mouse.y=getCanvasPos(e).y; },{passive:false});
canvas.addEventListener('touchmove',(e)=>{ e.preventDefault(); mouse.x=getCanvasPos(e).x; mouse.y=getCanvasPos(e).y; if(mouse.down && currentBird && currentBird.stuck){ const dx=mouse.x-sling.x,dy=mouse.y-sling.y,mag=Math.hypot(dx,dy),max=110; currentBird.x=sling.x+dx/mag*Math.min(mag,max); currentBird.y=sling.y+dy/mag*Math.min(mag,max);}},{passive:false});
canvas.addEventListener('touchend',(e)=>{ e.preventDefault(); mouse.down=false; if(currentBird && currentBird.stuck){ const dx=sling.x-currentBird.x, dy=sling.y-currentBird.y; currentBird.vx=dx*5.5; currentBird.vy=dy*5.5; currentBird.launched=true; currentBird.stuck=false;}},{passive:false});

// physics
function step(){
  if(currentBird && currentBird.alive && currentBird.launched){
    currentBird.vy+=gravity*dt;
    currentBird.x+=currentBird.vx*dt;
    currentBird.y+=currentBird.vy*dt;

    if(currentBird.y+currentBird.r>H-40){ currentBird.y=H-40-currentBird.r; currentBird.vy*=-0.35; currentBird.vx*=0.7; if(Math.hypot(currentBird.vx,currentBird.vy)<30) currentBird.vx=currentBird.vy=0; }
    if(currentBird.x<-80 || currentBird.x>W+80 || currentBird.y>H+80){ currentBird.alive=false; setTimeout(nextBird,200);}
    // collisions
    for(let i=0;i<blocks.length;i++){
      const b=blocks[i];
      const halfW=b.w/2, halfH=b.h/2;
      const nx=clamp(currentBird.x,b.x-halfW,b.x+halfW), ny=clamp(currentBird.y,b.y-halfH,b.y+halfH);
      const dx=currentBird.x-nx, dy=currentBird.y-ny;
      if(dx*dx+dy*dy<=currentBird.r*currentBird.r){
        currentBird.vx=-currentBird.vx*0.8; currentBird.vy=-currentBird.vy*0.8;
        b.hp-=Math.round(Math.hypot(currentBird.vx,currentBird.vy)*4);
        if(b.hp<=0){ blocks.splice(i,1); i--; score+=50; }
      }
    }
  }
  draw();
  requestAnimationFrame(step);
}

// draw
function draw(){
  ctx.clearRect(0,0,W,H);
  // ground
  ctx.fillStyle="#6BB56F";
  ctx.fillRect(0,H-40,W,40);
  // slingshot
  ctx.fillStyle="#5b3a29";
  ctx.fillRect(sling.x-10,sling.y,8,60); ctx.fillRect(sling.x+12,sling.y,8,60);
  if(currentBird && currentBird.stuck){ ctx.beginPath(); ctx.moveTo(sling.x-6,sling.y+6); ctx.lineTo(currentBird.x,currentBird.y); ctx.strokeStyle="brown"; ctx.lineWidth=6; ctx.stroke();}
  // blocks
  blocks.forEach(b=>{ ctx.fillStyle="saddlebrown"; ctx.fillRect(b.x-b.w/2,b.y-b.h/2,b.w,b.h);});
  // bird
  if(currentBird && currentBird.alive){ ctx.beginPath(); ctx.arc(currentBird.x,currentBird.y,currentBird.r,0,Math.PI*2); ctx.fillStyle="#f23b3b"; ctx.fill(); ctx.strokeStyle="#7a0000"; ctx.lineWidth=2; ctx.stroke();}
  // score
  ctx.fillStyle="#000"; ctx.font="16px sans-serif"; ctx.fillText("Score:"+score,10,20); ctx.fillText("Birds left:"+birdsLeft,10,40);
}

step();
</script>
</body>
</html>
